defaults:
  - /experiment/config/supervised_pretraining@config
  - salience/logging/pretrain@config.logging
  # set view-finder resolution
  - salience/env_interface_config/view_finder_128@config.env_interface_config
  - salience/motor_system/spiral@config.monty_config.motor_system_config

  # select object dataset to train on (all 77)
  - config/environment_interface/ycb/shuffled_objects@config.train_env_interface_args.object_names
  

# # We override some of the config values we got from supervised_pre_training_base
_target_: tbp.monty.frameworks.experiments.pretraining_experiments.MontySupervisedObjectPretrainingExperiment
config:
  n_train_epochs: 1
  logging:
    run_name: salience_pretrain_base
    output_dir: ${project.paths.pretrain_dir}/salience_pretrain_base
    
  monty_config:
    monty_args:
      num_exploratory_steps: 500

    learning_module_configs:
      learning_module_0:
        learning_module_class: ${monty.class:tbp.monty.frameworks.models.displacement_matching.DisplacementGraphLM}
        learning_module_args:
          k: 10
          match_attribute: displacement
          tolerance: ${np.array:[0.0001, 0.0001, 0.0001]}
          graph_delta_thresholds:
            patch:
              distance: 0.001
              pose_vectors: ${np.list_eval:[np.pi / 8, np.pi * 2, np.pi * 2]}
              principal_curvatures_log: [1, 1]
              hsv: [0.1, 1, 1]

  train_env_interface_args:
    object_names:
      - mug
    object_init_sampler:
      rotations:
        - [0, 0, 0]
  


# defaults:
#   - /experiment/config/supervised_pretraining@config
#   - /experiment/config/logging/defaults@config.logging
#   - /experiment/config/monty/patch_and_view@config.monty_config
#   # Set up the environment and agent.
#   - /experiment/config/environment/patch_view_finder_mount_habitat@config.env_interface_config
#   - /experiment/config/environment_interface/per_object@config.train_env_interface_args
#   - /experiment/config/environment_interface/ycb/shuffled_objects@config.train_env_interface_args.object_names

# _target_: tbp.monty.frameworks.experiments.pretraining_experiments.MontySupervisedObjectPretrainingExperiment
# config:
#   do_eval: false
#   max_train_steps: 1
#   n_train_epochs: 1
#   logging:
#     run_name: first_experiment
#   train_env_interface_class: ${monty.class:tbp.monty.frameworks.environments.embodied_data.EnvironmentInterfacePerObject}
#   train_env_interface_args:
#     object_init_sampler:
#       _target_: tbp.monty.frameworks.config_utils.make_env_interface_configs.PredefinedObjectInitializer
